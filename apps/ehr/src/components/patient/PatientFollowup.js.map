{"version":3,"file":"PatientFollowup.js","sourceRoot":"","sources":["PatientFollowup.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, CircularProgress, Grid, Typography } from '@mui/material';\nimport Oystehr from '@oystehr/sdk';\nimport { Encounter, Location } from 'fhir/r4b';\nimport { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { formatFhirEncounterToPatientFollowupDetails, getFullName, PatientFollowupDetails } from 'utils';\nimport { useApiClients } from '../../hooks/useAppClients';\nimport { useGetPatient } from '../../hooks/useGetPatient';\nimport PageContainer from '../../layout/PageContainer';\nimport CustomBreadcrumbs from '../CustomBreadcrumbs';\nimport { getFollowupStatusChip } from './PatientFollowupEncountersGrid';\nimport PatientFollowupForm from './PatientFollowupForm';\n\nexport default function PatientFollowup(): JSX.Element {\n  const { id, encounterId } = useParams();\n  const { patient } = useGetPatient(id);\n  const { oystehr } = useApiClients();\n  const [followupDetails, setFollowupDetails] = useState<PatientFollowupDetails | undefined>(undefined);\n  const [followupStatus, setFollowupStatus] = useState<'OPEN' | 'RESOLVED' | undefined>(undefined);\n\n  const fullName = patient ? getFullName(patient) : '';\n\n  useEffect(() => {\n    const getAndSetEncounterDetails = async (\n      oystehr: Oystehr,\n      encounterId: string,\n      patientId: string\n    ): Promise<void> => {\n      const fhirResources = (\n        await oystehr.fhir.search<Encounter | Location>({\n          resourceType: 'Encounter',\n          params: [\n            {\n              name: '_id',\n              value: encounterId,\n            },\n            {\n              name: '_include',\n              value: 'Encounter:location',\n            },\n          ],\n        })\n      ).unbundle();\n\n      const fhirEncounter = fhirResources.find((resource) => resource.resourceType === 'Encounter') as Encounter;\n      const fhirLocation = fhirResources.find((resource) => resource.resourceType === 'Location') as Location;\n\n      const formatted = formatFhirEncounterToPatientFollowupDetails(fhirEncounter, patientId, fhirLocation);\n      setFollowupDetails(formatted);\n      setFollowupStatus(formatted?.resolved ? 'RESOLVED' : 'OPEN');\n    };\n    if (encounterId && oystehr && patient?.id) {\n      void getAndSetEncounterDetails(oystehr, encounterId, patient.id);\n    }\n  }, [encounterId, oystehr, patient?.id]);\n\n  return (\n    <PageContainer>\n      <Grid container direction=\"row\">\n        <Grid item xs={3.5} />\n        <Grid item xs={5}>\n          {!followupStatus || !followupDetails || !patient ? (\n            <Box sx={{ justifyContent: 'left' }}>\n              <CircularProgress />\n            </Box>\n          ) : (\n            <>\n              <CustomBreadcrumbs\n                chain={[\n                  { link: '/patients', children: 'Patients' },\n                  {\n                    link: `/patient/${id}`,\n                    children: fullName,\n                  },\n                  {\n                    link: '#',\n                    children: 'Patient Follow-up',\n                  },\n                ]}\n              />\n              <Box\n                sx={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'space-between',\n                  marginTop: 2,\n                  marginBottom: 2,\n                }}\n              >\n                <Typography variant=\"h3\" marginTop={1} color={'primary.dark'}>\n                  Patient Follow-up\n                </Typography>\n                {getFollowupStatusChip(followupStatus)}\n              </Box>\n              <PatientFollowupForm\n                patient={patient}\n                followupDetails={followupDetails}\n                followupStatus={followupStatus}\n                setFollowupStatus={setFollowupStatus}\n              ></PatientFollowupForm>\n            </>\n          )}\n        </Grid>\n        <Grid item xs={3.5} />\n      </Grid>\n    </PageContainer>\n  );\n}\n"]}