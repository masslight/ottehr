{"version":3,"file":"VitalsHistoryEntry.js","sourceRoot":"","sources":["VitalsHistoryEntry.tsx"],"names":[],"mappings":"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","sourcesContent":["import { DeleteOutlined as DeleteIcon } from '@mui/icons-material';\nimport ErrorIcon from '@mui/icons-material/Error';\nimport WarningAmberOutlinedIcon from '@mui/icons-material/WarningAmberOutlined';\nimport { Box, IconButton, Typography, useTheme } from '@mui/material';\nimport React, { JSX, useState } from 'react';\nimport {\n  cmToInches,\n  formatDateTimeToLocalTimezone,\n  getVisionExtraOptionsFormattedString,\n  kgToLbs,\n  VitalsObservationDTO,\n} from 'utils';\nimport { DeleteVitalModal } from '../DeleteVitalModal';\n\ntype VitalHistoryElementProps<T extends VitalsObservationDTO = VitalsObservationDTO> = {\n  historyEntry: T;\n  onDelete?: (entity: VitalsObservationDTO) => Promise<void>;\n};\n\nexport const VitalHistoryElement: React.FC<VitalHistoryElementProps> = ({ historyEntry, onDelete }): JSX.Element => {\n  const theme = useTheme();\n\n  const isDeletable = onDelete !== undefined && historyEntry.resourceId !== undefined;\n\n  const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\n  const handleDeleteClick = (): void => {\n    setIsDeleteModalOpen(true);\n  };\n  const handleCloseDeleteModal = (): void => {\n    setIsDeleteModalOpen(false);\n  };\n\n  const hasAuthor = !!historyEntry.authorName && historyEntry.authorName?.length > 0;\n  const lineColor = (() => {\n    if (historyEntry.alertCriticality === 'critical') return theme.palette.error.main;\n    if (historyEntry.alertCriticality === 'abnormal') return theme.palette.warning.main;\n    return theme.palette.text.primary;\n  })();\n\n  const observationMethod = getObservationMethod(historyEntry);\n\n  const observationValueElements = getObservationValueElements(historyEntry, lineColor);\n\n  return (\n    <>\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n        <Typography color=\"textPrimary\" component=\"div\">\n          {formatDateTimeToLocalTimezone(historyEntry.lastUpdated)} {hasAuthor && 'by'} {historyEntry.authorName} -\n          &nbsp;\n          {observationValueElements.map((value, index) => {\n            if (typeof value === 'string') {\n              return (\n                <Typography\n                  key={index}\n                  component=\"span\"\n                  sx={{ fontWeight: index === 0 ? 'bold' : 'normal', color: lineColor }}\n                >\n                  {value}\n                </Typography>\n              );\n            } else {\n              return { ...value, key: index };\n            }\n          })}\n          {historyEntry.alertCriticality === 'critical' && (\n            <ErrorIcon fontSize=\"small\" sx={{ ml: '4px', verticalAlign: 'middle', color: lineColor }} />\n          )}\n          {historyEntry.alertCriticality === 'abnormal' && (\n            <WarningAmberOutlinedIcon\n              fontSize=\"small\"\n              sx={{ ml: '4px', verticalAlign: 'middle', color: theme.palette.warning.light }}\n            />\n          )}\n          {observationMethod && ` (${observationMethod})`}\n        </Typography>\n\n        {isDeletable && (\n          <IconButton\n            size=\"small\"\n            aria-label=\"delete\"\n            sx={{ ml: 'auto', color: theme.palette.warning.dark }}\n            onClick={handleDeleteClick}\n          >\n            <DeleteIcon fontSize=\"small\" />\n          </IconButton>\n        )}\n      </Box>\n\n      <DeleteVitalModal\n        open={isDeleteModalOpen}\n        onClose={handleCloseDeleteModal}\n        entity={historyEntry}\n        onDelete={async (obs) => onDelete?.(obs)}\n      />\n    </>\n  );\n};\n\nconst getObservationMethod = (historyEntry: VitalsObservationDTO): string | undefined => {\n  if (\n    historyEntry.field === 'vital-temperature' ||\n    historyEntry.field === 'vital-oxygen-sat' ||\n    historyEntry.field === 'vital-heartbeat' ||\n    historyEntry.field === 'vital-blood-pressure'\n  ) {\n    return historyEntry.observationMethod;\n  }\n  return undefined;\n};\n\nconst getObservationValueElements = (\n  historyEntry: VitalsObservationDTO,\n  lineColor: string\n): (string | JSX.Element)[] => {\n  // todo: it would be cool if the units came from the Observation resource\n  switch (historyEntry.field) {\n    case 'vital-temperature':\n      return [`${historyEntry.value} C`];\n    case 'vital-oxygen-sat':\n      return [`${historyEntry.value}%`];\n    case 'vital-heartbeat':\n      return [`${historyEntry.value}/min`];\n    case 'vital-blood-pressure':\n      return [`${historyEntry.systolicPressure}/${historyEntry.diastolicPressure} mm Hg`];\n    case 'vital-respiration-rate':\n      return [`${historyEntry.value}/min`];\n    case 'vital-weight':\n      return [`${historyEntry.value} kg`, ` / ${kgToLbs(historyEntry.value).toFixed(1)} lb`];\n    case 'vital-height':\n      return [`${historyEntry.value} cm`, ` / ${cmToInches(historyEntry.value).toFixed(0)} in`];\n    case 'vital-vision':\n      return [\n        <>\n          <Typography component=\"span\" sx={{ fontWeight: 'bold', color: lineColor }}>\n            Left eye: {historyEntry.leftEyeVisionText ?? '-'};&nbsp;\n          </Typography>\n          <Typography component=\"span\" sx={{ fontWeight: 'bold', color: lineColor }}>\n            Right eye: {historyEntry.rightEyeVisionText ?? '-'};&nbsp;{' '}\n            {`${getVisionExtraOptionsFormattedString(historyEntry.extraVisionOptions) ?? ''}`}\n          </Typography>\n        </>,\n      ];\n    default:\n      return [];\n  }\n};\nexport default VitalHistoryElement;\n"]}