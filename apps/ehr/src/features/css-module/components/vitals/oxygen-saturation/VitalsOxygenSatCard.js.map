{"version":3,"file":"VitalsOxygenSatCard.js","sourceRoot":"","sources":["VitalsOxygenSatCard.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Box, FormControl, Grid, InputLabel, MenuItem, Select, Typography } from '@mui/material';\nimport { enqueueSnackbar } from 'notistack';\nimport React, { ChangeEvent, JSX, useCallback, useState } from 'react';\nimport {\n  toVitalOxygenSatObservationMethod,\n  VitalFieldNames,\n  VitalsOxygenSatObservationDTO,\n  VitalsOxygenSatObservationMethod,\n} from 'utils';\nimport { RoundedButton } from '../../../../../components/RoundedButton';\nimport { AccordionCard, DoubleColumnContainer } from '../../../../../telemed/components';\nimport VitalsHistoryContainer from '../components/VitalsHistoryContainer';\nimport VitalHistoryElement from '../components/VitalsHistoryEntry';\nimport { VitalsTextInputFiled } from '../components/VitalsTextInputFiled';\nimport { useScreenDimensions } from '../hooks/useScreenDimensions';\nimport { VitalsCardProps } from '../types';\nimport { textToOxygenSatNumber } from './helpers';\n\ntype VitalsOxygenSatCardProps = VitalsCardProps<VitalsOxygenSatObservationDTO>;\nconst VitalsOxygenSatCard: React.FC<VitalsOxygenSatCardProps> = ({\n  handleSaveVital,\n  handleDeleteVital,\n  currentObs,\n  historicalObs,\n}): JSX.Element => {\n  const [oxySatValueText, setOxySatValueText] = useState('');\n\n  // the method how this Oxygen Saturation observation has been acquired\n  const [observationQualifier, setObservationsQualifier] = useState<string>('');\n\n  const [isOxySatValidationError, setOxySatValidationError] = useState<boolean>(false);\n\n  const [isCollapsed, setIsCollapsed] = useState<boolean>(false);\n  const handleSectionCollapse = useCallback(() => {\n    setIsCollapsed((prevCollapseState) => !prevCollapseState);\n  }, [setIsCollapsed]);\n\n  const [isSaving, setIsSaving] = useState(false);\n\n  const { isLargeScreen } = useScreenDimensions();\n\n  const isDisabledAddButton = !oxySatValueText || isOxySatValidationError;\n\n  const latestOxySatValue = currentObs[0]?.value;\n\n  const handleSaveOxySatObservation = useCallback(\n    async (oxySatValueText: string): Promise<void> => {\n      const oxySatValueNumber = textToOxygenSatNumber(oxySatValueText);\n      if (!oxySatValueNumber) return;\n\n      const observationMethod = toVitalOxygenSatObservationMethod(observationQualifier);\n      try {\n        setIsSaving(true);\n        const vitalObs: VitalsOxygenSatObservationDTO = {\n          field: VitalFieldNames.VitalOxygenSaturation,\n          value: oxySatValueNumber,\n          observationMethod: observationMethod,\n        };\n        await handleSaveVital(vitalObs);\n        setOxySatValueText('');\n        setObservationsQualifier('');\n      } catch {\n        enqueueSnackbar('Error saving oxygen saturation data', { variant: 'error' });\n      } finally {\n        setIsSaving(false);\n      }\n    },\n    [observationQualifier, handleSaveVital]\n  );\n\n  const handleTextInputChange = useCallback(\n    (e: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>): void => {\n      const oxySatAsText = e.target.value;\n      setOxySatValueText(oxySatAsText);\n      if (oxySatAsText.length === 0) {\n        setOxySatValidationError(false);\n      }\n    },\n    [setOxySatValidationError, setOxySatValueText]\n  );\n\n  const renderQualifierDropdown = (): JSX.Element => {\n    return (\n      <FormControl fullWidth size=\"small\" sx={{ backgroundColor: 'white' }} disabled={isSaving}>\n        <InputLabel id=\"qualifier-label\">Qualifier</InputLabel>\n        <Select\n          value={observationQualifier}\n          label=\"Qualifier\"\n          labelId=\"qualifier-label\"\n          variant=\"outlined\"\n          error={false}\n          defaultValue=\"\"\n          onChange={(event) => {\n            const eventValue = event.target.value;\n            const selectedQualifier = eventValue && eventValue.length > 0 ? eventValue : '';\n            setObservationsQualifier(selectedQualifier);\n          }}\n        >\n          <MenuItem key=\"default_obs_method\" value={''}>\n            <Typography color=\"textPrimary\" sx={{ fontSize: '16px' }}>\n              &nbsp;\n            </Typography>\n          </MenuItem>\n          {Object.values(VitalsOxygenSatObservationMethod).map((obsMethod) => (\n            <MenuItem key={obsMethod} value={obsMethod}>\n              <Typography color=\"textPrimary\" sx={{ fontSize: '16px' }}>\n                {obsMethod}\n              </Typography>\n            </MenuItem>\n          ))}\n        </Select>\n      </FormControl>\n    );\n  };\n\n  return (\n    <Box sx={{ mt: 3 }}>\n      <AccordionCard\n        label={`Oxygen sat (%) ${latestOxySatValue ?? ''}`}\n        collapsed={isCollapsed}\n        onSwitch={handleSectionCollapse}\n      >\n        <DoubleColumnContainer\n          divider\n          leftColumn={\n            <Grid\n              container\n              sx={{\n                height: 'auto',\n                width: 'auto',\n                backgroundColor: '#F7F8F9',\n                borderRadius: 2,\n                my: 2,\n                mx: 2,\n                py: 2,\n                px: 2,\n              }}\n            >\n              {/* Oxy sat Input Field column */}\n              <Grid item xs={12} sm={4} md={4} lg={4} order={{ xs: 1, sm: 1, md: 1 }}>\n                <VitalsTextInputFiled\n                  label=\"Sat (%)\"\n                  value={oxySatValueText}\n                  disabled={isSaving}\n                  isInputError={isOxySatValidationError}\n                  onChange={handleTextInputChange}\n                />\n              </Grid>\n\n              {/* Qualifier/method dropdown column */}\n              <Grid\n                item\n                xs={12}\n                sm={4}\n                md={4}\n                lg={4}\n                order={{ xs: 2, sm: 2, md: 2, lg: 2 }}\n                sx={{ mt: isLargeScreen ? 0 : 0 }}\n              >\n                <Box\n                  sx={{\n                    display: 'flex',\n                    flexDirection: 'row',\n                    ml: 1,\n                  }}\n                >\n                  {renderQualifierDropdown()}\n                </Box>\n              </Grid>\n\n              {/* Add Button column */}\n              <Grid item xs={12} sm={4} md={4} lg={4} order={{ xs: 3, sm: 3, md: 3, lg: 3 }} sx={{ mt: 0 }}>\n                <RoundedButton\n                  disabled={isDisabledAddButton}\n                  loading={isSaving}\n                  onClick={() => handleSaveOxySatObservation(oxySatValueText)}\n                  color=\"primary\"\n                  sx={{\n                    height: '40px',\n                    px: 2,\n                    ml: 1,\n                  }}\n                >\n                  Add\n                </RoundedButton>\n              </Grid>\n            </Grid>\n          }\n          rightColumn={\n            <VitalsHistoryContainer\n              currentEncounterObs={currentObs}\n              historicalObs={historicalObs}\n              isLoading={false}\n              historyElementCreator={(historyEntry) => {\n                const isCurrent = currentObs.some((obs) => obs.resourceId === historyEntry.resourceId);\n                return (\n                  <VitalHistoryElement\n                    historyEntry={historyEntry}\n                    onDelete={isCurrent ? handleDeleteVital : undefined}\n                  />\n                );\n              }}\n            />\n          }\n        />\n      </AccordionCard>\n    </Box>\n  );\n};\n\nexport default VitalsOxygenSatCard;\n"]}