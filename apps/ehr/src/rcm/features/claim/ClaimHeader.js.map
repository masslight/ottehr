{"version":3,"file":"ClaimHeader.js","sourceRoot":"","sources":["ClaimHeader.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useAuth0 } from '@auth0/auth0-react';\nimport { otherColors } from '@ehrTheme/colors';\nimport FileDownloadOutlinedIcon from '@mui/icons-material/FileDownloadOutlined';\nimport { Box, Button, Card, Typography } from '@mui/material';\nimport { DateTime } from 'luxon';\nimport React, { FC, useEffect, useState } from 'react';\nimport { ClaimsQueueItemStatus } from 'utils';\nimport { getPresignedFileUrl } from '../../../helpers/files.helper';\nimport { getSelectors } from '../../../shared/store/getSelectors';\nimport { useClaimStore } from '../../state';\nimport { ClaimStatusChip } from '../claims-queue';\n\nconst formatDate = (date: string): string => {\n  const dt = DateTime.fromISO(date);\n  return `Last updated on ${dt.toFormat('MM/dd/yyyy')} at ${dt.toFormat('h:mm a')}`;\n};\n\nexport const ClaimHeader: FC = () => {\n  const { patientData, claim, appointment, visitNoteDocument } = getSelectors(useClaimStore, [\n    'patientData',\n    'claim',\n    'appointment',\n    'visitNoteDocument',\n  ]);\n  const { getAccessTokenSilently } = useAuth0();\n\n  const [visitNotePresignedURL, setVisitNotePresignedURL] = useState<string>();\n\n  useEffect(() => {\n    async function getPresignedTemplateUrls(): Promise<void> {\n      try {\n        const authToken = await getAccessTokenSilently();\n\n        const z3Url = visitNoteDocument?.content?.[0]?.attachment.url;\n        if (z3Url) {\n          const presignedUrl = await getPresignedFileUrl(z3Url, authToken);\n          setVisitNotePresignedURL(presignedUrl);\n        }\n      } catch {\n        console.error('Error while trying to get presigned url');\n      }\n    }\n\n    if (visitNoteDocument) {\n      void getPresignedTemplateUrls();\n    }\n  }, [getAccessTokenSilently, visitNoteDocument]);\n\n  const status = claim?.meta?.tag?.find((tag) => tag.system === 'current-status')?.code;\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        flexDirection: 'column',\n        gap: 0.5,\n      }}\n    >\n      <Box\n        sx={{\n          display: 'flex',\n          gap: 2,\n          alignItems: 'center',\n        }}\n      >\n        <Typography variant=\"h3\" color=\"primary.dark\">\n          Claim for {patientData?.firstLastName}\n        </Typography>\n\n        {status && <ClaimStatusChip status={status as ClaimsQueueItemStatus} />}\n\n        {claim?.meta?.lastUpdated && (\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            {formatDate(claim.meta.lastUpdated)}\n          </Typography>\n        )}\n      </Box>\n\n      <Box\n        sx={{\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'flex-end',\n        }}\n      >\n        <Box\n          sx={{\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 0.5,\n          }}\n        >\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            CID: {claim?.id}\n          </Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            VID: {appointment?.id}\n          </Typography>\n        </Box>\n\n        <Box sx={{ display: 'flex', gap: 2 }}>\n          <Card\n            elevation={0}\n            sx={{\n              backgroundColor: otherColors.lightIconButton,\n              display: 'flex',\n              alignItems: 'center',\n              px: 2,\n              gap: 1,\n            }}\n          >\n            <Typography variant=\"subtitle1\" fontSize={16} color=\"primary.dark\">\n              Full visit note\n            </Typography>\n\n            <Button\n              sx={{\n                textTransform: 'none',\n                fontWeight: 500,\n                fontSize: 16,\n              }}\n              startIcon={<FileDownloadOutlinedIcon />}\n              disabled={!visitNotePresignedURL}\n              onClick={() => window.open(visitNotePresignedURL, '_blank')}\n            >\n              Download PDF\n            </Button>\n          </Card>\n\n          {/*<RoundedButton startIcon={<RestartAltIcon />}>Refresh Demographics</RoundedButton>*/}\n          {/*<RoundedButton startIcon={<OpenInNewIcon />}>Export</RoundedButton>*/}\n        </Box>\n      </Box>\n    </Box>\n  );\n};\n"]}