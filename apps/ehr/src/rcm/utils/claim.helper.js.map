{"version":3,"file":"claim.helper.js","sourceRoot":"","sources":["claim.helper.ts"],"names":[],"mappings":"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","sourcesContent":["import { Claim, ClaimAccident, ClaimSupportingInfo, CodeableConcept, Coding } from 'fhir/r4b';\nimport { DateTime } from 'luxon';\nimport { FHIR_EXTENSION } from 'utils';\nimport {\n  AdditionalInformationFormValues,\n  BillingFormValues,\n  DiagnosesFormValues,\n  SLBProviderFormValues,\n} from './form-values.types';\nimport { getDateFromISO } from './resources.helper';\n\nfunction getCode(codeableConcept: CodeableConcept | undefined, system: string): string | undefined {\n  return codeableConcept?.coding?.find((coding) => coding.system === system)?.code;\n}\n\nfunction isSupportingInfo(supportingInfo: ClaimSupportingInfo, category: string): boolean {\n  return getCode(supportingInfo.category, FHIR_EXTENSION.Claim.claimInformationCategory.url) === category;\n}\n\nfunction findSupportingInfo(\n  supportingInfo: ClaimSupportingInfo[] | undefined,\n  category: string\n): ClaimSupportingInfo | undefined {\n  return supportingInfo?.find((supportingInfo) => isSupportingInfo(supportingInfo, category));\n}\n\nexport const getClaimData = (\n  claim?: Claim\n): {\n  conditionRelatedToEmployment: boolean;\n  conditionRelatedToAutoAccident: boolean;\n  autoAccidentState?: string;\n  conditionRelatedToOtherAccident: boolean;\n  conditionRelatedToMixed: string;\n  claimCode1?: string;\n  claimCode2?: string;\n  claimCode3?: string;\n  claimCodes: string;\n  dateOfIllness?: DateTime;\n  unableToWork: { start?: DateTime; end?: DateTime };\n  unableToWorkString?: string;\n  hospitalizationDates: { start?: DateTime; end?: DateTime };\n  hospitalizationDatesString?: string;\n  resubmissionCode?: string;\n  priorAuthNumber?: string;\n  diagnoses?: { code: string; display: string }[];\n  diagnosesComment?: string;\n  facilityId?: string;\n  billingItems?: {\n    date: [DateTime | null, DateTime | null];\n    // place: string;\n    emergency: boolean;\n    code: string;\n    modifiers: string;\n    // pointerA: boolean;\n    // pointerB: boolean;\n    charges: number;\n    units: number;\n    // epsdt: boolean;\n    // provider: string;\n  }[];\n  totalCharge?: number;\n  patientPaid?: number;\n} => {\n  // 10a\n  const conditionRelatedToEmployment = !!claim?.accident?.type?.coding?.find(\n    (coding) => coding.code === 'WPA' && coding.system === FHIR_EXTENSION.Claim.v3_ActCode.url\n  );\n  // 10b\n  const conditionRelatedToAutoAccident = !!claim?.accident?.type?.coding?.find(\n    (coding) => coding.code === 'MVA' && coding.system === FHIR_EXTENSION.Claim.v3_ActCode.url\n  );\n  const autoAccidentState = claim?.accident?.locationAddress?.state;\n  // 10c\n  const conditionRelatedToOtherAccident = !!claim?.accident?.type?.coding?.find(\n    (coding) => coding.code === undefined && coding.system === FHIR_EXTENSION.Claim.v3_ActCode.url\n  );\n\n  const conditionRelatedToMixed = [\n    conditionRelatedToEmployment && 'a. Employment',\n    conditionRelatedToAutoAccident && autoAccidentState && `b. Auto accident, ${autoAccidentState}`,\n    conditionRelatedToOtherAccident && 'c. Other accident',\n  ]\n    .filter((value) => !!value)\n    .join(', ');\n\n  // 10d\n  const claimCodeExtensions = claim?.extension?.filter(\n    (extension) => extension.url === FHIR_EXTENSION.Claim.claimConditionCode.url\n  );\n  const claimCode1 = claimCodeExtensions?.[0]?.valueString;\n  const claimCode2 = claimCodeExtensions?.[1]?.valueString;\n  const claimCode3 = claimCodeExtensions?.[2]?.valueString;\n\n  const claimCodes = [claimCode1, claimCode2, claimCode3].filter((value) => !!value).join(', ');\n\n  // 14\n  const dateOfIllness = claim && getDateFromISO(findSupportingInfo(claim.supportingInfo, 'onset')?.timingDate);\n\n  // 16\n  const employmentImpacted = claim && findSupportingInfo(claim.supportingInfo, 'employmentimpacted');\n\n  const unableToWork = {\n    start: getDateFromISO(employmentImpacted?.timingPeriod?.start),\n    end: getDateFromISO(employmentImpacted?.timingPeriod?.end),\n  };\n\n  const unableToWorkString =\n    unableToWork.start &&\n    unableToWork.end &&\n    `${unableToWork.start.toFormat('MM/dd/yyyy')}-${unableToWork.end.toFormat('MM/dd/yyyy')}`;\n\n  // 18\n  const hospitalized = claim && findSupportingInfo(claim.supportingInfo, 'hospitalized');\n\n  const hospitalizationDates = {\n    start: getDateFromISO(hospitalized?.timingPeriod?.start),\n    end: getDateFromISO(hospitalized?.timingPeriod?.end),\n  };\n\n  const hospitalizationDatesString =\n    hospitalizationDates.start &&\n    hospitalizationDates.end &&\n    `${hospitalizationDates.start.toFormat('MM/dd/yyyy')}-${hospitalizationDates.end.toFormat('MM/dd/yyyy')}`;\n\n  // 22 resubmission code\n  const resubmissionCode = claim?.related?.[0]?.relationship?.coding?.find(\n    (coding) => coding.system === FHIR_EXTENSION.Claim.resubmissionRelationship.url\n  )?.code;\n\n  // 23\n  const priorAuthNumber = claim?.insurance?.[0]?.preAuthRef?.[0];\n\n  // 21\n  const diagnoses = claim?.diagnosis?.map((diagnosis) => ({\n    code: diagnosis.diagnosisCodeableConcept?.coding?.[0]?.code || '',\n    display: diagnosis.diagnosisCodeableConcept?.coding?.[0]?.display || '',\n  }));\n\n  const diagnosesComment = claim?.extension?.find(\n    (extension) => extension.url === FHIR_EXTENSION.Claim.claimDiagnosesComment.url\n  )?.valueString;\n\n  // 32\n  const facilityId = claim?.facility?.reference?.split('/')?.[1];\n\n  // 24\n  const billingItems = claim?.item?.map((item) => ({\n    date: [\n      item.servicedPeriod?.start ? DateTime.fromISO(item.servicedPeriod.start) : null,\n      item.servicedPeriod?.end ? DateTime.fromISO(item.servicedPeriod.end) : null,\n    ] as [DateTime | null, DateTime | null],\n    // place: '', // ?\n    emergency: !!item.revenue?.coding?.find(\n      (coding) => coding.system === FHIR_EXTENSION.Claim.revenueCode.url && coding.code === '1001'\n    ),\n    code:\n      item.productOrService?.coding?.find((coding) => coding.system === 'http://www.ama-assn.org/go/cpt')?.code || '',\n    modifiers:\n      item.modifier\n        ?.filter(\n          (modifier) => modifier?.coding?.find((coding) => coding.system === FHIR_EXTENSION.Claim.procedureModifier.url)\n        )\n        .map(\n          (modifier) =>\n            modifier?.coding?.find((coding) => coding.system === FHIR_EXTENSION.Claim.procedureModifier.url)?.code\n        )\n        .join(', ') || '',\n    // pointerA: false, // ?\n    // pointerB: false, // ?\n    charges: item.unitPrice?.value || 0,\n    units: item.quantity?.value || 0,\n    // epsdt: false, // ?\n    // provider: '', // ?\n  }));\n\n  // 28\n  const totalCharge = claim?.total?.value;\n\n  // 29\n  const patientPaid = claim?.extension?.find((extension) => extension.url === FHIR_EXTENSION.Claim.patientPaid.url)\n    ?.valueMoney?.value;\n\n  return {\n    conditionRelatedToEmployment,\n    conditionRelatedToAutoAccident,\n    autoAccidentState,\n    conditionRelatedToOtherAccident,\n    conditionRelatedToMixed,\n    claimCode1,\n    claimCode2,\n    claimCode3,\n    claimCodes,\n    dateOfIllness,\n    unableToWork,\n    unableToWorkString,\n    hospitalizationDates,\n    hospitalizationDatesString,\n    resubmissionCode,\n    priorAuthNumber,\n    diagnoses,\n    diagnosesComment,\n    facilityId,\n    billingItems,\n    totalCharge,\n    patientPaid,\n  };\n};\n\nconst createAccidentCodingByCode = (code: 'WPA' | 'MVA' | undefined): Coding => ({\n  code,\n  system: FHIR_EXTENSION.Claim.v3_ActCode.url,\n});\n\nexport const mapAdditionalInformationToClaimResource = (\n  claim: Claim,\n  additionalInformation: AdditionalInformationFormValues\n): Claim => {\n  const claimCopy = structuredClone(claim) as Claim;\n\n  // 10a-c\n  if (\n    additionalInformation.relatedToEmployment ||\n    additionalInformation.relatedToAutoAccident ||\n    additionalInformation.relatedToOtherAccident\n  ) {\n    const claimAccident: ClaimAccident = { date: '', type: { coding: [] } };\n\n    if (additionalInformation.relatedToEmployment) {\n      claimAccident.type!.coding!.push(createAccidentCodingByCode('WPA'));\n    }\n    if (additionalInformation.relatedToAutoAccident) {\n      claimAccident.type!.coding!.push(createAccidentCodingByCode('MVA'));\n      claimAccident.locationAddress = { state: additionalInformation.relatedToAutoAccident };\n    }\n    if (additionalInformation.relatedToOtherAccident) {\n      claimAccident.type!.coding!.push(createAccidentCodingByCode(undefined));\n    }\n\n    claimCopy.accident = claimAccident;\n  } else {\n    claimCopy.accident = undefined;\n  }\n\n  // 10d\n  const claimCodes = additionalInformation.claimCodes\n    .trim()\n    .split(' ')\n    .filter((c) => c)\n    .slice(0, 3);\n\n  claimCopy.extension = [\n    ...(claimCopy.extension || []).filter((extension) => extension.url !== FHIR_EXTENSION.Claim.claimConditionCode.url),\n    ...claimCodes.map((code) => ({ url: FHIR_EXTENSION.Claim.claimConditionCode.url, valueString: code })),\n  ];\n\n  if (claimCopy.extension.length === 0) {\n    claimCopy.extension = undefined;\n  }\n\n  // 14\n  if (additionalInformation.illness) {\n    const illnessSupportingInfo = {\n      timingDate: additionalInformation.illness?.toISO() || undefined,\n      category: { coding: [{ system: FHIR_EXTENSION.Claim.claimInformationCategory.url, code: 'onset' }] },\n    };\n    let changed = false;\n\n    claimCopy.supportingInfo = claimCopy.supportingInfo?.map((supportingInfo) => {\n      if (isSupportingInfo(supportingInfo, 'onset')) {\n        changed = true;\n        return {\n          ...supportingInfo,\n          ...illnessSupportingInfo,\n        };\n      } else {\n        return supportingInfo;\n      }\n    });\n\n    if (!changed) {\n      claimCopy.supportingInfo = [\n        ...(claimCopy.supportingInfo || []),\n        {\n          ...illnessSupportingInfo,\n          sequence: 2,\n        },\n      ];\n    }\n  } else {\n    claimCopy.supportingInfo = claimCopy.supportingInfo?.filter(\n      (supportingInfo) => !isSupportingInfo(supportingInfo, 'onset')\n    );\n  }\n\n  // 16\n  if (additionalInformation.unableToWork[0] && additionalInformation.unableToWork[1]) {\n    const unableToWorkSupportingInfo = {\n      timingPeriod: {\n        start: additionalInformation.unableToWork[0]?.toISO() || undefined,\n        end: additionalInformation.unableToWork[1]?.toISO() || undefined,\n      },\n      category: { coding: [{ system: FHIR_EXTENSION.Claim.claimInformationCategory.url, code: 'employmentimpacted' }] },\n    };\n    let changed = false;\n\n    claimCopy.supportingInfo = claimCopy.supportingInfo?.map((supportingInfo) => {\n      if (isSupportingInfo(supportingInfo, 'employmentimpacted')) {\n        changed = true;\n        return {\n          ...supportingInfo,\n          ...unableToWorkSupportingInfo,\n        };\n      } else {\n        return supportingInfo;\n      }\n    });\n\n    if (!changed) {\n      claimCopy.supportingInfo = [\n        ...(claimCopy.supportingInfo || []),\n        {\n          ...unableToWorkSupportingInfo,\n          sequence: 3,\n        },\n      ];\n    }\n  } else {\n    claimCopy.supportingInfo = claimCopy.supportingInfo?.filter(\n      (supportingInfo) => !isSupportingInfo(supportingInfo, 'employmentimpacted')\n    );\n  }\n\n  // 18\n  if (additionalInformation.hospitalization[0] && additionalInformation.hospitalization[1]) {\n    const hospitalizationSupportingInfo = {\n      timingPeriod: {\n        start: additionalInformation.hospitalization[0]?.toISO() || undefined,\n        end: additionalInformation.hospitalization[1]?.toISO() || undefined,\n      },\n      category: { coding: [{ system: FHIR_EXTENSION.Claim.claimInformationCategory.url, code: 'hospitalized' }] },\n    };\n    let changed = false;\n\n    claimCopy.supportingInfo = claimCopy.supportingInfo?.map((supportingInfo) => {\n      if (isSupportingInfo(supportingInfo, 'hospitalized')) {\n        changed = true;\n        return {\n          ...supportingInfo,\n          ...hospitalizationSupportingInfo,\n        };\n      } else {\n        return supportingInfo;\n      }\n    });\n\n    if (!changed) {\n      claimCopy.supportingInfo = [\n        ...(claimCopy.supportingInfo || []),\n        {\n          ...hospitalizationSupportingInfo,\n          sequence: 4,\n        },\n      ];\n    }\n  } else {\n    claimCopy.supportingInfo = claimCopy.supportingInfo?.filter(\n      (supportingInfo) => !isSupportingInfo(supportingInfo, 'hospitalized')\n    );\n  }\n\n  // 22\n  if (additionalInformation.resubmissionCode) {\n    claimCopy.related = claimCopy.related?.map((related, index) =>\n      index === 0\n        ? {\n            ...related,\n            relationship: {\n              ...related.relationship,\n              coding: related.relationship?.coding?.find(\n                (coding) => coding.system === FHIR_EXTENSION.Claim.resubmissionRelationship.url\n              )\n                ? related.relationship?.coding?.map((coding) =>\n                    coding.system === FHIR_EXTENSION.Claim.resubmissionRelationship.url\n                      ? { ...coding, code: additionalInformation.resubmissionCode }\n                      : coding\n                  )\n                : [\n                    ...(related.relationship?.coding || []),\n                    {\n                      system: FHIR_EXTENSION.Claim.resubmissionRelationship.url,\n                      code: additionalInformation.resubmissionCode,\n                    },\n                  ],\n            },\n          }\n        : related\n    );\n  } else {\n    claimCopy.related = claimCopy.related?.map((related, index) =>\n      index === 0\n        ? {\n            ...related,\n            relationship: {\n              ...related.relationship,\n              coding: related.relationship?.coding?.filter(\n                (coding) => coding.system !== FHIR_EXTENSION.Claim.resubmissionRelationship.url\n              ),\n            },\n          }\n        : related\n    );\n  }\n\n  // 23\n  claimCopy.insurance = claimCopy.insurance.map((insurance, index) =>\n    index === 0\n      ? {\n          ...insurance,\n          preAuthRef: additionalInformation.authorizationNumber\n            ? [additionalInformation.authorizationNumber]\n            : undefined,\n        }\n      : insurance\n  );\n\n  return claimCopy;\n};\n\nexport const mapDiagnosesToClaimResource = (claim: Claim, diagnoses: DiagnosesFormValues): Claim => {\n  const claimCopy = structuredClone(claim) as Claim;\n\n  claimCopy.extension = [\n    ...(claimCopy.extension || []).filter(\n      (extension) => extension.url !== FHIR_EXTENSION.Claim.claimDiagnosesComment.url\n    ),\n    ...(diagnoses.comment.trim()\n      ? [{ url: FHIR_EXTENSION.Claim.claimDiagnosesComment.url, valueString: diagnoses.comment.trim() }]\n      : []),\n  ];\n\n  if (claimCopy.extension.length === 0) {\n    claimCopy.extension = undefined;\n  }\n\n  claimCopy.diagnosis = diagnoses.items.map((item, index) => ({\n    sequence: index + 1,\n    diagnosisCodeableConcept: {\n      coding: [\n        {\n          code: item?.code,\n          display: item?.display,\n        },\n      ],\n    },\n  }));\n\n  if (claimCopy.diagnosis.length === 0) {\n    claimCopy.diagnosis = undefined;\n  }\n\n  return claimCopy;\n};\n\nexport const mapBillingToClaimResource = (claim: Claim, billing: BillingFormValues): Claim => {\n  const claimCopy = structuredClone(claim) as Claim;\n\n  if (isNaN(billing.payment)) {\n    claimCopy.extension = claimCopy.extension?.filter(\n      (extension) => extension.url !== FHIR_EXTENSION.Claim.patientPaid.url\n    );\n  } else {\n    const paymentExtension = { url: FHIR_EXTENSION.Claim.patientPaid.url, valueMoney: { value: billing.payment } };\n    let changed = false;\n\n    claimCopy.extension = claimCopy.extension?.map((extension) => {\n      if (extension.url === FHIR_EXTENSION.Claim.patientPaid.url) {\n        changed = true;\n        return paymentExtension;\n      }\n      return extension;\n    });\n\n    if (!changed) {\n      claimCopy.extension = [...(claimCopy.extension || []), paymentExtension];\n    }\n  }\n\n  if (claimCopy.extension?.length === 0) {\n    claimCopy.extension = undefined;\n  }\n\n  if (billing.items.length === 0) {\n    claimCopy.total = { value: 0 };\n    claimCopy.item = undefined;\n  } else {\n    claimCopy.total = {\n      value: billing.items.reduce((prev, curr) => {\n        prev += curr.charges;\n        return prev;\n      }, 0),\n    };\n\n    claimCopy.item = billing.items.map((item, index) => ({\n      sequence: index + 1,\n      productOrService: { coding: [{ system: 'http://www.ama-assn.org/go/cpt', code: item.code }] },\n      servicedPeriod: {\n        start: item.date[0]?.toISO() || undefined,\n        end: item.date[1]?.toISO() || undefined,\n      },\n      revenue: item.emergency\n        ? { coding: [{ system: FHIR_EXTENSION.Claim.revenueCode.url, coding: '1001' }] }\n        : undefined,\n      unitPrice: { value: item.charges },\n      quantity: { value: item.units },\n      modifier:\n        item.modifiers.split(', ').length > 0\n          ? item.modifiers\n              .split(', ')\n              .map((modifier) => ({ coding: [{ system: FHIR_EXTENSION.Claim.procedureModifier.url, code: modifier }] }))\n          : undefined,\n    }));\n  }\n\n  return claimCopy;\n};\n\nexport const mapSLBProviderToClaimResource = (claim: Claim, slbProvider: SLBProviderFormValues): Claim => {\n  const claimCopy = structuredClone(claim) as Claim;\n\n  if (slbProvider.location?.id) {\n    claimCopy.facility = { reference: `Location/${slbProvider.location.id}` };\n  }\n\n  if (slbProvider.location?.managingOrganization?.reference) {\n    claimCopy.provider = { reference: slbProvider.location.managingOrganization.reference };\n  }\n\n  return claimCopy;\n};\n"]}