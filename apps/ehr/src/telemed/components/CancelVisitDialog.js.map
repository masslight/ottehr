{"version":3,"file":"CancelVisitDialog.js","sourceRoot":"","sources":["CancelVisitDialog.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,gCAAyC;AACzC,0CAauB;AACvB,+BAAsD;AACtD,qDAA0D;AAC1D,+BAAqE;AACrE,qCAAyD;AACzD,2DAA0D;AAM1D,IAAM,iBAAiB,GAAG,UAAC,EAAmC;QAAjC,OAAO,aAAA;IAC5B,IAAA,KAAsB,IAAA,gBAAQ,EAAC,EAAE,CAAC,EAAjC,MAAM,QAAA,EAAE,SAAS,QAAgB,CAAC;IACnC,IAAA,KAAoB,IAAA,gBAAQ,EAAU,KAAK,CAAC,EAA3C,KAAK,QAAA,EAAE,QAAQ,QAA4B,CAAC;IAC7C,IAAA,KAAgC,IAAA,gBAAQ,EAAC,EAAE,CAAC,EAA3C,WAAW,QAAA,EAAE,cAAc,QAAgB,CAAC;IAC7C,IAAA,KAAkC,IAAA,gBAAQ,EAAC,KAAK,CAAC,EAAhD,YAAY,QAAA,EAAE,eAAe,QAAmB,CAAC;IAChD,IAAA,aAAa,GAAK,IAAA,6BAAa,GAAE,cAApB,CAAqB;IAClC,IAAI,aAAa,GAAK,IAAA,4BAAS,GAAE,GAAhB,CAAiB;IAC1C,IAAM,QAAQ,GAAG,IAAA,8BAAW,GAAE,CAAC;IAE/B,IAAM,mBAAmB,GAAG,MAAM,CAAC,MAAM,CAAC,oDAA4C,CAAC,CAAC;IAExF,IAAM,kBAAkB,GAAG,UAAC,KAAgC;QAC1D,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAC9B,IAAI,KAAK,CAAC,MAAM,CAAC,KAAK,KAAK,OAAO,EAAE,CAAC;YACnC,cAAc,CAAC,EAAE,CAAC,CAAC;QACrB,CAAC;IACH,CAAC,CAAC;IAEF,IAAM,uBAAuB,GAAG,UAAC,KAA0C;QACzE,cAAc,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IACrC,CAAC,CAAC;IAEF,IAAM,uBAAuB,GAAG,UAAO,KAAuC;;;;;oBAC5E,KAAK,CAAC,cAAc,EAAE,CAAC;oBACvB,QAAQ,CAAC,KAAK,CAAC,CAAC;oBAChB,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,KAAK,OAAO,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC;wBACpD,sBAAO;oBACT,CAAC;oBACD,eAAe,CAAC,IAAI,CAAC,CAAC;oBACtB,IAAI,CAAC,aAAa;wBAAE,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;oBAE/D,IAAI,mBAAmB,CAAC,IAAI,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,KAAK,MAAM,EAAZ,CAAY,CAAC,KAAK,SAAS,EAAE,CAAC;wBAChE,MAAM,IAAI,KAAK,CAAC,uCAAgC,MAAM,CAAE,CAAC,CAAC;oBAC5D,CAAC;oBAEK,WAAW,GAAG,MAAsD,CAAC;oBACvE,aAAa,GAAG,KAAK,CAAC;;;;oBAEP,qBAAM,IAAA,8BAAwB,EAAC,aAAa,EAAE;4BAC7D,aAAa,EAAE,aAAa,IAAI,EAAE;4BAClC,kBAAkB,EAAE,WAAW;4BAC/B,4BAA4B,EAAE,WAAW;yBAC1C,CAAC,EAAA;;oBAJI,QAAQ,GAAG,SAIf;oBACF,OAAO,CAAC,GAAG,CAAC,oCAAoC,EAAE,QAAQ,CAAC,CAAC;;;;oBAE5D,QAAQ,CAAC,IAAI,CAAC,CAAC;oBACf,aAAa,GAAG,IAAI,CAAC;oBACrB,OAAO,CAAC,KAAK,CAAC,8BAA8B,EAAE,OAAK,CAAC,CAAC;;;oBAErD,eAAe,CAAC,KAAK,CAAC,CAAC;oBACvB,IAAI,CAAC,aAAa,EAAE,CAAC;wBACnB,OAAO,EAAE,CAAC;wBACV,QAAQ,CAAC,uBAAuB,CAAC,CAAC;oBACpC,CAAC;;;;;SAEJ,CAAC;IAEF,IAAM,QAAQ,GAAG;QACf,UAAU,EAAE,GAAG;QACf,aAAa,EAAE,MAAM;QACrB,YAAY,EAAE,CAAC;QACf,EAAE,EAAE,CAAC;QACL,EAAE,EAAE,CAAC;KACN,CAAC;IAEF,OAAO,CACL,CAAC,iBAAM,CACL,IAAI,CAAC,CAAC,IAAI,CAAC,CACX,OAAO,CAAC,CAAC,OAAO,CAAC,CACjB,SAAS,CACT,iBAAiB,CACjB,EAAE,CAAC,CAAC;YACF,gBAAgB,EAAE;gBAChB,OAAO,EAAE,CAAC;gBACV,KAAK,EAAE,OAAO;gBACd,QAAQ,EAAE,SAAS;aACpB;SACF,CAAC,CAEF;MAAA,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,UAAC,CAAC,IAAK,OAAA,uBAAuB,CAAC,CAAC,CAAC,EAA1B,CAA0B,CAAC,CAChD;QAAA,CAAC,sBAAW,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,CACnE;;QACF,EAAE,sBAAW,CACb;QAAA,CAAC,wBAAa,CACZ;UAAA,CAAC,sBAAW,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,CAC5C;YAAA,CAAC,qBAAU,CAAC,EAAE,CAAC,2BAA2B,CAAC,mBAAmB,EAAE,qBAAU,CAC1E;YAAA,CAAC,iBAAM,CACL,OAAO,CAAC,2BAA2B,CACnC,EAAE,CAAC,qBAAqB,CACxB,KAAK,CAAC,CAAC,MAAM,CAAC,CACd,KAAK,CAAC,qBAAqB,CAC3B,QAAQ,CAAC,CAAC,kBAAkB,CAAC,CAE7B;cAAA,CAAC,mBAAmB,CAAC,GAAG,CAAC,UAAC,MAAM,IAAK,OAAA,CACnC,CAAC,mBAAQ,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,CACnC;kBAAA,CAAC,MAAM,CACT;gBAAA,EAAE,mBAAQ,CAAC,CACZ,EAJoC,CAIpC,CAAC,CACJ;YAAA,EAAE,iBAAM,CACV;UAAA,EAAE,sBAAW,CACb;UAAA,CAAC,MAAM,KAAK,OAAO,IAAI,CACrB,CAAC,sBAAW,CAAC,SAAS,CAAC,QAAQ,CAC7B;cAAA,CAAC,oBAAS,CACR,EAAE,CAAC,cAAc,CACjB,KAAK,CAAC,QAAQ,CACd,OAAO,CAAC,UAAU,CAClB,SAAS,CACT,QAAQ,CAAC,CAAC,IAAI,CAAC,CACf,MAAM,CAAC,QAAQ,CACf,KAAK,CAAC,CAAC,WAAW,CAAC,CACnB,QAAQ,CAAC,CAAC,uBAAuB,CAAC,EAEtC;YAAA,EAAE,sBAAW,CAAC,CACf,CACH;QAAA,EAAE,wBAAa,CACf;QAAA,CAAC,wBAAa,CAAC,EAAE,CAAC,CAAC,EAAE,cAAc,EAAE,YAAY,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,CACjE;UAAA,CAAC,mBAAa,CACZ,OAAO,CAAC,CAAC,YAAY,CAAC,CACtB,IAAI,CAAC,QAAQ,CACb,OAAO,CAAC,WAAW,CACnB,KAAK,CAAC,SAAS,CACf,IAAI,CAAC,QAAQ,CACb,EAAE,CAAC,CAAC,QAAQ,CAAC,CAEb;;UACF,EAAE,mBAAa,CACf;UAAA,CAAC,iBAAM,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,CAClF;;UACF,EAAE,iBAAM,CACV;QAAA,EAAE,wBAAa,CACf;QAAA,CAAC,KAAK,IAAI,CACR,CAAC,qBAAU,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CACrD;;UACF,EAAE,qBAAU,CAAC,CACd,CACH;MAAA,EAAE,IAAI,CACR;IAAA,EAAE,iBAAM,CAAC,CACV,CAAC;AACJ,CAAC,CAAC;AAEF,kBAAe,iBAAiB,CAAC","sourcesContent":["import { LoadingButton } from '@mui/lab';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  InputLabel,\n  MenuItem,\n  Select,\n  SelectChangeEvent,\n  TextField,\n  Typography,\n} from '@mui/material';\nimport React, { ReactElement, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { CancellationReasonOptionsProviderSideTelemed } from 'utils';\nimport { cancelTelemedAppointment } from '../../api/api';\nimport { useApiClients } from '../../hooks/useAppClients';\n\ninterface CancelVisitDialogProps {\n  onClose: () => void;\n}\n\nconst CancelVisitDialog = ({ onClose }: CancelVisitDialogProps): ReactElement => {\n  const [reason, setReason] = useState('');\n  const [error, setError] = useState<boolean>(false);\n  const [otherReason, setOtherReason] = useState('');\n  const [isCancelling, setIsCancelling] = useState(false);\n  const { oystehrZambda } = useApiClients();\n  const { id: appointmentID } = useParams();\n  const navigate = useNavigate();\n\n  const cancellationReasons = Object.values(CancellationReasonOptionsProviderSideTelemed);\n\n  const handleReasonChange = (event: SelectChangeEvent<string>): void => {\n    setReason(event.target.value);\n    if (event.target.value !== 'Other') {\n      setOtherReason('');\n    }\n  };\n\n  const handleOtherReasonChange = (event: React.ChangeEvent<HTMLInputElement>): void => {\n    setOtherReason(event.target.value);\n  };\n\n  const handleCancelAppointment = async (event: React.FormEvent<HTMLFormElement>): Promise<void> => {\n    event.preventDefault();\n    setError(false);\n    if (!reason || (reason === 'Other' && !otherReason)) {\n      return;\n    }\n    setIsCancelling(true);\n    if (!oystehrZambda) throw new Error('Zambda client not found');\n\n    if (cancellationReasons.find((r) => r === reason) === undefined) {\n      throw new Error(`Invalid cancellation reason: ${reason}`);\n    }\n\n    const typedReason = reason as CancellationReasonOptionsProviderSideTelemed;\n    let errorReceived = false;\n    try {\n      const response = await cancelTelemedAppointment(oystehrZambda, {\n        appointmentID: appointmentID || '',\n        cancellationReason: typedReason,\n        cancellationReasonAdditional: otherReason,\n      });\n      console.log('Appointment cancelled successfully', response);\n    } catch (error) {\n      setError(true);\n      errorReceived = true;\n      console.error('Failed to cancel appointment', error);\n    } finally {\n      setIsCancelling(false);\n      if (!errorReceived) {\n        onClose();\n        navigate('/telemed/appointments');\n      }\n    }\n  };\n\n  const buttonSx = {\n    fontWeight: 500,\n    textTransform: 'none',\n    borderRadius: 6,\n    mb: 2,\n    ml: 1,\n  };\n\n  return (\n    <Dialog\n      open={true}\n      onClose={onClose}\n      fullWidth\n      disableScrollLock\n      sx={{\n        '.MuiPaper-root': {\n          padding: 1,\n          width: '444px',\n          maxWidth: 'initial',\n        },\n      }}\n    >\n      <form onSubmit={(e) => handleCancelAppointment(e)}>\n        <DialogTitle variant=\"h4\" color=\"primary.dark\" sx={{ width: '100%' }}>\n          Cancellation reason\n        </DialogTitle>\n        <DialogContent>\n          <FormControl fullWidth required sx={{ mt: 2 }}>\n            <InputLabel id=\"cancellation-reason-label\">Cancellation Reason</InputLabel>\n            <Select\n              labelId=\"cancellation-reason-label\"\n              id=\"cancellation-reason\"\n              value={reason}\n              label=\"Cancellation Reason\"\n              onChange={handleReasonChange}\n            >\n              {cancellationReasons.map((reason) => (\n                <MenuItem key={reason} value={reason}>\n                  {reason}\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n          {reason === 'Other' && (\n            <FormControl fullWidth required>\n              <TextField\n                id=\"other-reason\"\n                label=\"Reason\"\n                variant=\"outlined\"\n                fullWidth\n                required={true}\n                margin=\"normal\"\n                value={otherReason}\n                onChange={handleOtherReasonChange}\n              />\n            </FormControl>\n          )}\n        </DialogContent>\n        <DialogActions sx={{ justifyContent: 'flex-start', marginLeft: 1 }}>\n          <LoadingButton\n            loading={isCancelling}\n            type=\"submit\"\n            variant=\"contained\"\n            color=\"primary\"\n            size=\"medium\"\n            sx={buttonSx}\n          >\n            Cancel visit\n          </LoadingButton>\n          <Button onClick={onClose} variant=\"text\" color=\"primary\" size=\"medium\" sx={buttonSx}>\n            Keep\n          </Button>\n        </DialogActions>\n        {error && (\n          <Typography color=\"error\" variant=\"body2\" my={1} mx={2}>\n            There was an error cancelling this appointment, please try again.\n          </Typography>\n        )}\n      </form>\n    </Dialog>\n  );\n};\n\nexport default CancelVisitDialog;\n"]}