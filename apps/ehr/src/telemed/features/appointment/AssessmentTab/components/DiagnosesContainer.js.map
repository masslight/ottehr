{"version":3,"file":"DiagnosesContainer.js","sourceRoot":"","sources":["DiagnosesContainer.tsx"],"names":[],"mappings":"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","sourcesContent":["import { otherColors } from '@ehrTheme/colors';\nimport InfoOutlinedIcon from '@mui/icons-material/InfoOutlined';\nimport { Box, Button, Typography } from '@mui/material';\nimport { enqueueSnackbar } from 'notistack';\nimport { FC } from 'react';\nimport { APIErrorCode, DIAGNOSIS_MAKE_PRIMARY_BUTTON, IcdSearchResponse } from 'utils';\nimport { CompleteConfiguration } from '../../../../../components/CompleteConfiguration';\nimport { GenericToolTip } from '../../../../../components/GenericToolTip';\nimport { dataTestIds } from '../../../../../constants/data-test-ids';\nimport { useFeatureFlags } from '../../../../../features/css-module/context/featureFlags';\nimport { getSelectors } from '../../../../../shared/store/getSelectors';\nimport { ActionsList, DeleteIconButton } from '../../../../components';\nimport { useGetAppointmentAccessibility } from '../../../../hooks';\nimport { useAppointmentStore, useDeleteChartData, useGetIcd10Search, useSaveChartData } from '../../../../state';\nimport { AssessmentTitle } from './AssessmentTitle';\nimport { DiagnosesField } from './DiagnosesField';\n\nexport const DiagnosesContainer: FC = () => {\n  const { chartData, setPartialChartData } = getSelectors(useAppointmentStore, ['chartData', 'setPartialChartData']);\n  const { isAppointmentReadOnly: isReadOnly } = useGetAppointmentAccessibility();\n  const { mutate: saveChartData, isLoading: isSaveLoading } = useSaveChartData();\n  const { mutateAsync: deleteChartData, isLoading: isDeleteLoading } = useDeleteChartData();\n  const { error: icdSearchError } = useGetIcd10Search({ search: 'E11', sabs: 'ICD10CM' });\n\n  const nlmApiKeyMissing = icdSearchError?.code === APIErrorCode.MISSING_NLM_API_KEY_ERROR;\n\n  const isLoading = isSaveLoading || isDeleteLoading;\n\n  const diagnoses = chartData?.diagnosis || [];\n  const primaryDiagnosis = diagnoses.find((item) => item.isPrimary);\n  const otherDiagnoses = diagnoses.filter((item) => !item.isPrimary);\n\n  const { css } = useFeatureFlags();\n\n  const onAdd = (value: IcdSearchResponse['codes'][number]): void => {\n    const preparedValue = { ...value, isPrimary: !primaryDiagnosis };\n\n    saveChartData(\n      {\n        diagnosis: [preparedValue],\n      },\n      {\n        onSuccess: (data) => {\n          const diagnosis = (data.chartData.diagnosis || [])[0];\n          if (diagnosis) {\n            setPartialChartData({\n              diagnosis: [...diagnoses, diagnosis],\n            });\n          }\n        },\n        onError: () => {\n          enqueueSnackbar('An error has occurred while adding diagnosis. Please try again.', { variant: 'error' });\n          setPartialChartData({\n            diagnosis: diagnoses,\n          });\n        },\n      }\n    );\n    setPartialChartData({ diagnosis: [...diagnoses, preparedValue] });\n  };\n\n  const onDelete = async (resourceId: string): Promise<void> => {\n    let localDiagnoses = diagnoses;\n    const preparedValue = localDiagnoses.find((item) => item.resourceId === resourceId)!;\n\n    await deleteChartData(\n      {\n        diagnosis: [preparedValue],\n      },\n      {\n        onError: () => {\n          enqueueSnackbar('An error has occurred while deleting diagnosis. Please try again.', { variant: 'error' });\n        },\n      }\n    );\n    localDiagnoses = localDiagnoses.filter((item) => item.resourceId !== resourceId);\n\n    if (preparedValue.isPrimary && otherDiagnoses.length > 0) {\n      const firstAppropriateDiagnosis = otherDiagnoses.find((diagnosis) => !diagnosis.code.startsWith('W'));\n\n      if (firstAppropriateDiagnosis) {\n        const otherDiagnosis = { ...firstAppropriateDiagnosis, isPrimary: true };\n        const prevDiagnoses = localDiagnoses;\n\n        saveChartData(\n          {\n            diagnosis: [otherDiagnosis],\n          },\n          {\n            onError: () => {\n              enqueueSnackbar(\n                'An error has occurred while setting primary diagnosis. Please try to set primary diagnosis manually.',\n                { variant: 'error' }\n              );\n              setPartialChartData({\n                diagnosis: prevDiagnoses,\n              });\n            },\n          }\n        );\n\n        localDiagnoses = localDiagnoses.map((item) =>\n          item.resourceId === otherDiagnosis.resourceId ? otherDiagnosis : item\n        );\n      }\n    }\n    setPartialChartData({ diagnosis: localDiagnoses });\n  };\n\n  const onMakePrimary = (resourceId: string): void => {\n    const value = diagnoses.find((item) => item.resourceId === resourceId)!;\n    const previousAndNewValues = [];\n    previousAndNewValues.push({ ...value, isPrimary: true }); // prepared diagnosis\n    if (primaryDiagnosis) previousAndNewValues.push({ ...primaryDiagnosis, isPrimary: false }); // previous diagnosis\n\n    saveChartData(\n      {\n        diagnosis: previousAndNewValues,\n      },\n      {\n        onError: () => {\n          enqueueSnackbar('An error has occurred while changing primary diagnosis. Please try again.', {\n            variant: 'error',\n          });\n          setPartialChartData({\n            diagnosis: diagnoses,\n          });\n        },\n      }\n    );\n\n    setPartialChartData({\n      diagnosis: diagnoses.map((item) => {\n        if (item.isPrimary) {\n          return { ...item, isPrimary: false };\n        }\n        if (item.resourceId === resourceId) {\n          return { ...item, isPrimary: true };\n        }\n        return item;\n      }),\n    });\n  };\n\n  const handleSetup = (): void => {\n    window.open('https://docs.oystehr.com/ottehr/setup/terminology/', '_blank');\n  };\n  const addedViaLabOrderInfo = (\n    <GenericToolTip title=\"Added during lab order\" placement=\"right\">\n      <InfoOutlinedIcon style={{ color: otherColors.disabled, height: '15px', width: '15px' }} />\n    </GenericToolTip>\n  );\n\n  return (\n    <Box\n      sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}\n      data-testid={dataTestIds.diagnosisContainer.allDiagnosesContainer}\n    >\n      <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n        <AssessmentTitle>{css ? 'Dx' : 'Diagnoses'}</AssessmentTitle>\n        {!isReadOnly && <DiagnosesField onChange={onAdd} disabled={isLoading} disableForPrimary={!primaryDiagnosis} />}\n      </Box>\n\n      {isReadOnly && diagnoses.length === 0 && <Typography color=\"secondary.light\">Not provided</Typography>}\n\n      {nlmApiKeyMissing && <CompleteConfiguration handleSetup={handleSetup} />}\n\n      {primaryDiagnosis && (\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n          <AssessmentTitle>Primary *</AssessmentTitle>\n          <ActionsList\n            data={[primaryDiagnosis]}\n            getKey={(value, index) => value.resourceId || index}\n            renderItem={(value) => (\n              <Typography data-testid={dataTestIds.diagnosisContainer.primaryDiagnosis}>\n                {value.display} {value.code} {value.addedViaLabOrder && addedViaLabOrderInfo}\n              </Typography>\n            )}\n            renderActions={\n              isReadOnly\n                ? undefined\n                : (value) => (\n                    <DeleteIconButton\n                      dataTestId={dataTestIds.diagnosisContainer.primaryDiagnosisDeleteButton}\n                      disabled={isLoading || !value.resourceId}\n                      onClick={() => onDelete(value.resourceId!)}\n                    />\n                  )\n            }\n          />\n        </Box>\n      )}\n\n      {otherDiagnoses.length > 0 && (\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n          <AssessmentTitle>Secondary (optional)</AssessmentTitle>\n          <ActionsList\n            data={otherDiagnoses}\n            getKey={(value, index) => value.resourceId || index}\n            renderItem={(value) => (\n              <Typography data-testid={dataTestIds.diagnosisContainer.secondaryDiagnosis}>\n                {value.display} {value.code} {value.addedViaLabOrder && addedViaLabOrderInfo}\n              </Typography>\n            )}\n            renderActions={\n              isReadOnly\n                ? undefined\n                : (value) => (\n                    <Box sx={{ display: 'flex', gap: 1, alignItems: 'center' }}>\n                      {!value.code.startsWith('W') && (\n                        <Button\n                          disabled={isLoading || !value.resourceId}\n                          onClick={() => onMakePrimary(value.resourceId!)}\n                          size=\"small\"\n                          data-testid={dataTestIds.diagnosisContainer.makePrimaryButton}\n                          sx={{ textTransform: 'none', fontWeight: 500 }}\n                        >\n                          {DIAGNOSIS_MAKE_PRIMARY_BUTTON}\n                        </Button>\n                      )}\n                      <DeleteIconButton\n                        dataTestId={dataTestIds.diagnosisContainer.secondaryDiagnosisDeleteButton}\n                        disabled={isLoading || !value.resourceId}\n                        onClick={() => onDelete(value.resourceId!)}\n                      />\n                    </Box>\n                  )\n            }\n            divider\n          />\n        </Box>\n      )}\n    </Box>\n  );\n};\n"]}