{"version":3,"file":"VitalsComponent.js","sourceRoot":"","sources":["VitalsComponent.tsx"],"names":[],"mappings":"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","sourcesContent":["import { FC, useCallback, useEffect } from 'react';\nimport { Controller, useForm } from 'react-hook-form';\nimport { getQuestionnaireResponseByLinkId } from 'utils';\nimport { getSelectors } from '../../../../../../shared/store/getSelectors';\nimport { useDebounce } from '../../../../../hooks';\nimport { useAppointmentStore, useUpdatePaperwork } from '../../../../../state';\nimport { updateQuestionnaireResponse } from '../../../../../utils';\nimport { NumberInput } from '../NumberInput';\n\ntype VitalsComponentProps = {\n  name: 'vitals-pulse' | 'vitals-hr' | 'vitals-rr' | 'vitals-bp';\n  label: string;\n  validate: (value: string) => string | undefined;\n};\n\nexport const VitalsComponent: FC<VitalsComponentProps> = (props) => {\n  const { name, label, validate } = props;\n\n  const { appointment, questionnaireResponse } = getSelectors(useAppointmentStore, [\n    'appointment',\n    'questionnaireResponse',\n  ]);\n  const defaultValue = getQuestionnaireResponseByLinkId(name, questionnaireResponse)?.answer?.[0]?.valueString;\n  const { control, handleSubmit, watch } = useForm<{\n    [name: string]: string;\n  }>({\n    defaultValues: {\n      [name]: (defaultValue === 'N/A' ? '' : defaultValue) || '',\n    },\n  });\n  const { mutate } = useUpdatePaperwork();\n  const { debounce, clear } = useDebounce(1000);\n\n  const onSubmit = useCallback(\n    (value: { [name: string]: string }): void => {\n      debounce(() => {\n        mutate(\n          {\n            appointmentID: appointment!.id!,\n            paperwork: {\n              [name]: value[name] || 'N/A',\n            },\n          },\n          {\n            onSuccess: () => {\n              updateQuestionnaireResponse(questionnaireResponse, name, value[name] || 'N/A');\n            },\n          }\n        );\n      });\n    },\n    [questionnaireResponse, debounce, mutate, appointment, name]\n  );\n\n  useEffect(() => {\n    const subscription = watch(() => handleSubmit(onSubmit)());\n    return () => subscription.unsubscribe();\n  }, [handleSubmit, watch, onSubmit]);\n\n  return (\n    <Controller\n      name={name}\n      control={control}\n      rules={{\n        validate: (value) => {\n          const result = validate(value);\n          if (result) {\n            clear();\n            return result;\n          }\n          return;\n        },\n      }}\n      render={({ field: { value, onChange }, fieldState: { error } }) => (\n        <NumberInput\n          helperText={error ? error.message : null}\n          error={!!error}\n          label={label}\n          value={value}\n          onChange={onChange}\n          sx={{ flex: 1 }}\n        />\n      )}\n    />\n  );\n};\n"]}