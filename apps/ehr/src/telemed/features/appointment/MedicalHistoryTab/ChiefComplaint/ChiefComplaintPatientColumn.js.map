{"version":3,"file":"ChiefComplaintPatientColumn.js","sourceRoot":"","sources":["ChiefComplaintPatientColumn.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useAuth0 } from '@auth0/auth0-react';\nimport { Box, Skeleton, Typography, useTheme } from '@mui/material';\nimport { FC, useEffect, useState } from 'react';\nimport { AiObservationField, ObservationTextFieldDTO } from 'utils';\nimport AiSuggestion from '../../../../../components/AiSuggestion';\nimport ImageCarousel, { ImageCarouselObject } from '../../../../../components/ImageCarousel';\nimport { dataTestIds } from '../../../../../constants/data-test-ids';\nimport { getPresignedFileUrl } from '../../../../../helpers/files.helper';\nimport { getSelectors } from '../../../../../shared/store/getSelectors';\nimport { useAppointmentStore } from '../../../../state';\n\nexport const ChiefComplaintPatientColumn: FC = () => {\n  const theme = useTheme();\n  const { isAppointmentLoading, patientPhotoUrls, appointment, chartData } = getSelectors(useAppointmentStore, [\n    'isAppointmentLoading',\n    'patientPhotoUrls',\n    'appointment',\n    'chartData',\n  ]);\n\n  const [signedPhotoUrls, setSignedPhotoUrls] = useState<string[]>([]);\n  const [photoUrlsLoading, setPhotoUrlsLoading] = useState<boolean>(false);\n  const { getAccessTokenSilently } = useAuth0();\n  const photoCarouselObjects: ImageCarouselObject[] = signedPhotoUrls.map((url, ind) => ({\n    url: url,\n    alt: `Patient condition photo #${ind + 1}`,\n  }));\n  const [photoZoom, setPhotoZoom] = useState<boolean>(false);\n  const [zoomedIdx, setZoomedIdx] = useState<number>(0);\n\n  useEffect(() => {\n    async function getPresignedPhotoUrls(): Promise<void> {\n      try {\n        setPhotoUrlsLoading(true);\n        const authToken = await getAccessTokenSilently();\n        const requests: Promise<string | undefined>[] = [];\n        patientPhotoUrls.forEach((url) => {\n          requests.push(getPresignedFileUrl(url, authToken));\n        });\n        const signedUrls = await Promise.all(requests);\n        setSignedPhotoUrls(signedUrls.filter(Boolean) as string[]);\n      } catch {\n        console.error('Error while trying to get patient photo presigned urls');\n      } finally {\n        setPhotoUrlsLoading(false);\n      }\n    }\n\n    if (patientPhotoUrls?.length > 0) {\n      void getPresignedPhotoUrls();\n    }\n  }, [getAccessTokenSilently, patientPhotoUrls]);\n\n  const aiHistoryOfPresentIllness = chartData?.observations?.find(\n    (observation) => observation.field === AiObservationField.HistoryOfPresentIllness\n  ) as ObservationTextFieldDTO;\n\n  return (\n    <Box sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\n      <ImageCarousel\n        imagesObj={photoCarouselObjects}\n        imageIndex={zoomedIdx}\n        setImageIndex={setZoomedIdx}\n        open={photoZoom}\n        setOpen={setPhotoZoom}\n      />\n      <Box>\n        <Typography variant=\"subtitle2\" color={theme.palette.primary.dark}>\n          Reason for visit selected by patient\n        </Typography>\n        {isAppointmentLoading ? (\n          <Skeleton width=\"100%\">\n            <Typography>.</Typography>\n          </Skeleton>\n        ) : (\n          <Typography data-testid={dataTestIds.telemedEhrFlow.hpiReasonForVisit}>\n            {appointment?.description ?? ''}\n          </Typography>\n        )}\n      </Box>\n      {(isAppointmentLoading || photoUrlsLoading || photoCarouselObjects?.length > 0) && (\n        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n          <Box sx={{ display: 'flex', gap: 1 }}>\n            <Typography variant=\"subtitle2\" color={theme.palette.primary.dark}>\n              Photo of patientâ€™s condition\n            </Typography>\n            <Typography variant=\"subtitle2\" color={theme.palette.text.secondary}>\n              Click to zoom\n            </Typography>\n          </Box>\n          {isAppointmentLoading ? (\n            <Box sx={{ width: '100%', display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gridGap: 16 }}>\n              {[1, 2].map((item) => (\n                <Box key={item} sx={{ aspectRatio: '1/1' }}>\n                  <Skeleton variant=\"rounded\" height=\"100%\" />\n                </Box>\n              ))}\n            </Box>\n          ) : (\n            <Box\n              sx={{ width: '100%', display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gridGap: 16 }}\n              data-testid={dataTestIds.telemedEhrFlow.hpiPatientConditionPhotos}\n            >\n              {photoCarouselObjects.map((photoObj, ind) => (\n                <Box key={photoObj.url} display=\"inline-block\" sx={{ cursor: 'pointer' }}>\n                  <img\n                    onClick={() => {\n                      setPhotoZoom(true);\n                      setZoomedIdx(ind);\n                    }}\n                    style={{ width: '100%', height: '100%', objectFit: 'cover', borderRadius: 8 }}\n                    src={photoObj.url}\n                    alt={photoObj.alt}\n                    loading=\"lazy\"\n                  />\n                </Box>\n              ))}\n            </Box>\n          )}\n        </Box>\n      )}\n      {aiHistoryOfPresentIllness ? (\n        <>\n          <hr style={{ border: '0.5px solid #DFE5E9', margin: '0 -16px 0 -16px' }} />\n          <AiSuggestion title={'History of Present Illness (HPI)'} content={aiHistoryOfPresentIllness.value} />\n        </>\n      ) : undefined}\n    </Box>\n  );\n};\n"]}