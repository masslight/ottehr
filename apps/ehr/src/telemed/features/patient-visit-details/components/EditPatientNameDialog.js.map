{"version":3,"file":"EditPatientNameDialog.js","sourceRoot":"","sources":["EditPatientNameDialog.tsx"],"names":[],"mappings":"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","sourcesContent":["import CloseOutlinedIcon from '@mui/icons-material/CloseOutlined';\nimport { LoadingButton } from '@mui/lab';\nimport {\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  IconButton,\n  TextField,\n  Typography,\n} from '@mui/material';\nimport { Patient } from 'fhir/r4b';\nimport { ReactElement, useEffect, useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { getSelectors } from '../../../../shared/store/getSelectors';\nimport { useEditPatientNameMutation } from '../../../hooks';\nimport { useAppointmentStore } from '../../../state';\n\ninterface EditPatientNameDialogProps {\n  modalOpen: boolean;\n  onClose: () => void;\n}\n\ninterface FormInputs {\n  firstName?: string;\n  middleName?: string;\n  lastName?: string;\n}\n\nexport const EditPatientNameDialog = ({ modalOpen, onClose }: EditPatientNameDialogProps): ReactElement => {\n  const { register, handleSubmit, formState, setValue } = useForm<FormInputs>();\n  const [error, setError] = useState(false);\n  const { patient } = getSelectors(useAppointmentStore, ['patient']);\n\n  useEffect(() => {\n    setValue('firstName', patient?.name?.[0]?.given?.[0]);\n    setValue('middleName', patient?.name?.[0]?.given?.[1]);\n    setValue('lastName', patient?.name?.[0]?.family);\n  }, [patient, setValue]);\n\n  const editPatientName = useEditPatientNameMutation();\n\n  const onSubmit = async (data: FormInputs): Promise<void> => {\n    try {\n      if (!patient?.id) {\n        throw new Error('Patient reference not provided');\n      }\n\n      const patientData: Patient = {\n        ...patient,\n        resourceType: 'Patient',\n        id: patient.id,\n        name: [\n          {\n            use: 'official',\n            family: data.lastName,\n            given: [data.firstName!],\n          },\n        ],\n      };\n      if (data.middleName) {\n        patientData.name![0].given?.push(data.middleName);\n      }\n      await editPatientName.mutateAsync(\n        { patientData: patientData },\n        {\n          onSuccess: (updatedData) => {\n            useAppointmentStore.setState({\n              patient: { ...updatedData },\n            });\n            onClose();\n          },\n        }\n      );\n    } catch (error) {\n      setError(true);\n      console.error('Error while updating patient name: ', error);\n    }\n  };\n\n  return (\n    <Dialog\n      open={modalOpen}\n      onClose={onClose}\n      fullWidth\n      disableScrollLock\n      sx={{ '.MuiPaper-root': { padding: 1, width: '444px', maxWidth: 'initial' } }}\n    >\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <DialogTitle\n          variant=\"h4\"\n          color=\"primary.dark\"\n          sx={{ width: '100%', py: 1, display: 'flex', justifyContent: 'space-between', alignItems: 'center', mt: 1 }}\n        >\n          Please enter patient name\n          <IconButton onClick={onClose} aria-label=\"close\" sx={{ mr: -3, mt: -3 }}>\n            <CloseOutlinedIcon />\n          </IconButton>\n        </DialogTitle>\n        <DialogContent>\n          <FormControl fullWidth required sx={{ mt: 1 }}>\n            <TextField\n              {...register('firstName', { required: true })}\n              id=\"first-name\"\n              label=\"First Name\"\n              variant=\"outlined\"\n              fullWidth\n              error={!!formState.errors.firstName}\n              required\n            />\n          </FormControl>\n          <FormControl fullWidth sx={{ mt: 2 }}>\n            <TextField\n              {...register('middleName')}\n              id=\"middle-name\"\n              label=\"Middle Name\"\n              variant=\"outlined\"\n              fullWidth\n              error={!!formState.errors.middleName}\n            />\n          </FormControl>\n          <FormControl fullWidth required sx={{ mt: 2 }}>\n            <TextField\n              {...register('lastName', { required: true })}\n              id=\"last-name\"\n              label=\"Last Name\"\n              variant=\"outlined\"\n              fullWidth\n              error={!!formState.errors.lastName}\n              required\n            />\n          </FormControl>\n        </DialogContent>\n        <DialogActions sx={{ justifyContent: 'flex-start', marginLeft: 1 }}>\n          <LoadingButton\n            loading={editPatientName.isLoading}\n            type=\"submit\"\n            variant=\"contained\"\n            color=\"primary\"\n            size=\"medium\"\n            sx={{ fontWeight: 500, textTransform: 'none', borderRadius: 6, ml: 1, mb: 1, px: 4 }}\n            disabled={!formState.isValid}\n          >\n            Update Patient Name\n          </LoadingButton>\n        </DialogActions>\n        {error && (\n          <Typography color=\"error\" variant=\"body2\" my={1} mx={2}>\n            Failed to update patient name, please try again.\n          </Typography>\n        )}\n      </form>\n    </Dialog>\n  );\n};\n"]}