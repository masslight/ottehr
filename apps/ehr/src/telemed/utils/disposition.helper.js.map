{"version":3,"file":"disposition.helper.js","sourceRoot":"","sources":["disposition.helper.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  dispositionCheckboxOptions,\n  DispositionDTO,\n  DispositionFollowUpType,\n  DispositionType,\n  followUpInOptions,\n  NOTHING_TO_EAT_OR_DRINK_FIELD,\n  PROJECT_NAME,\n} from 'utils';\n\nexport const dispositionFieldsPerType: { [key in DispositionType]: string[] } = {\n  pcp: ['followUpIn', 'followUpType'],\n  ip: ['bookVisit'],\n  'ip-lab': ['labService', 'bookVisit', 'followUpType'],\n  ed: [NOTHING_TO_EAT_OR_DRINK_FIELD],\n  'ip-oth': [],\n  'pcp-no-type': ['followUpIn'],\n  another: ['reason'],\n  specialty: ['followUpIn'],\n};\n\nexport const DEFAULT_DISPOSITION_VALUES: DispositionFormValues = {\n  type: 'pcp-no-type',\n  note: '',\n  followUpIn: '',\n  reason: '',\n  labService: [],\n  virusTest: [],\n  dentistry: false,\n  ent: false,\n  ophthalmology: false,\n  orthopedics: false,\n  other: false,\n  'lurie-ct': false,\n  otherNote: '',\n  [NOTHING_TO_EAT_OR_DRINK_FIELD]: false,\n};\n\nexport type DispositionFormValues = Pick<DispositionDTO, 'type' | 'note' | typeof NOTHING_TO_EAT_OR_DRINK_FIELD> & {\n  [key in DispositionFollowUpType]: boolean;\n} & {\n  otherNote: string;\n  followUpIn: number | '';\n  labService: string[];\n  virusTest: string[];\n  reason: string;\n};\n\nexport const mapFormToDisposition = (values: DispositionFormValues): DispositionDTO => {\n  const disposition: DispositionDTO = { type: values.type, note: values.note || 'N/A' };\n\n  const fields = dispositionFieldsPerType[disposition.type];\n\n  if (fields.includes('labService')) {\n    disposition.labService = values.labService || [];\n    disposition.virusTest = values.virusTest || [];\n  }\n\n  if (fields.includes('followUpIn')) {\n    disposition.followUpIn = values.followUpIn === '' ? undefined : values.followUpIn;\n  }\n\n  if (fields.includes('reason')) {\n    disposition.reason = values.reason === '' ? undefined : values.reason;\n  }\n\n  if (fields.includes('followUpType')) {\n    disposition.followUp = [];\n\n    dispositionCheckboxOptions.forEach((option) => {\n      const isOtherOption = option.name === 'other';\n      const otherOptionValue = option.name === 'other' ? values.otherNote?.trim?.() : undefined;\n      const isOtherOptionWithValue = isOtherOption && otherOptionValue;\n\n      if ((!isOtherOption && values[option.name]) || isOtherOptionWithValue) {\n        disposition.followUp!.push({\n          type: option.name,\n          note: option.name === 'other' ? otherOptionValue : undefined,\n        });\n      }\n    });\n\n    if (disposition.followUp.length === 0) {\n      delete disposition.followUp;\n    }\n  }\n\n  if (fields.includes(NOTHING_TO_EAT_OR_DRINK_FIELD)) {\n    disposition[NOTHING_TO_EAT_OR_DRINK_FIELD] = values[NOTHING_TO_EAT_OR_DRINK_FIELD];\n  }\n\n  return disposition;\n};\n\nexport const mapDispositionToForm = (disposition: DispositionDTO): DispositionFormValues => {\n  const values = { ...DEFAULT_DISPOSITION_VALUES };\n\n  values.type = disposition.type;\n  values.note = disposition.note === 'N/A' ? '' : disposition.note;\n\n  const fields = dispositionFieldsPerType[disposition.type];\n\n  if (fields.includes('labService')) {\n    values.labService = disposition.labService || [];\n    values.virusTest = disposition.virusTest || [];\n  }\n\n  if (fields.includes('followUpIn')) {\n    values.followUpIn = typeof disposition.followUpIn === 'number' ? disposition.followUpIn : '';\n  }\n\n  if (fields.includes('reason')) {\n    values.reason = disposition.reason || '';\n  }\n\n  if (fields.includes('followUpType')) {\n    disposition.followUp?.forEach((followUp) => {\n      values[followUp.type] = true;\n      if (followUp.type === 'other') {\n        values.otherNote = followUp.note || '';\n      }\n    });\n  }\n\n  if (fields.includes(NOTHING_TO_EAT_OR_DRINK_FIELD)) {\n    values[NOTHING_TO_EAT_OR_DRINK_FIELD] = disposition[NOTHING_TO_EAT_OR_DRINK_FIELD];\n  }\n\n  return values;\n};\n\nexport { followUpInOptions };\n\nexport const SEND_OUT_VIRUS_TEST_LABEL = 'Send out virus test';\n\nexport const labServiceOptions = [\n  {\n    label: 'COVID PCR',\n    note: `Based on our medical evaluation, you will undergo COVID-19 PCR testing. You will be provided with additional instructions to access your patient portal and view test results during your in-person visit at our office. The ${PROJECT_NAME} Telemedicine app is available daily beginning at 8AM to patients from birth through age 26 for all virtual urgent care needs. The Covid PCR test will be scheduled.`,\n  },\n  {\n    label: 'COVID Rapid Antigen only',\n    note: `Based on our medical evaluation, you will undergo a COVID-19 Rapid Antigen test. You will be provided with additional instructions to access your patient portal and view test results during your in-person visit at our office. The ${PROJECT_NAME} Telemedicine app is available daily beginning at 8AM to patients from birth through age 26 for all virtual urgent care needs. Your Covid Rapid Antigen test will be scheduled.`,\n  },\n  {\n    label: 'COVID Rapid Antigen & Reflex PCR',\n    note: `Based on our medical evaluation, you will undergo a COVID-19 Rapid Antigen test. If this rapid test is negative, a more accurate confirmatory “PCR” will be sent to the lab. You will be provided with additional instructions to access your patient portal and view test results during your in-person visit at our office. The ${PROJECT_NAME} Telemedicine app is available daily beginning at 8AM to patients from birth through age 26 for all virtual urgent care needs. The Covid Rapid Antigen Test will be scheduled.`,\n  },\n  { label: 'Multiple Tests', note: `For the following tests, please proceed to ${PROJECT_NAME}.` },\n  {\n    label: 'Rapid Strep/Throat Culture',\n    note: `Based on our medical evaluation, you will undergo a rapid Strep test. If the rapid test is positive, a provider at ${PROJECT_NAME} will be in contact with you within 2 hours and provide a prescription. If the rapid test is negative, a confirmatory test will be sent to the lab and we will notify you if the results indicate a need for treatment. Confirmatory lab results may take up to 5 days to return. All lab results and instructions from your child's provider can be found in your patient portal.`,\n  },\n  {\n    label: 'Rapid Strep/Throat Culture & COVID PCR',\n    note: `Based on our medical evaluation, you will undergo a COVID-19 test. Based on our medical evaluation, you will ALSO undergo a rapid Strep test. If the rapid test is positive, a provider at ${PROJECT_NAME} will be in contact with you within 2 hours and provide a prescription. If the rapid test is negative, a confirmatory test will be sent to the lab and we will notify you if the results indicate a need for treatment. Confirmatory lab results may take up to 5 days to return. All lab results and instructions from your child's provider can be found in your patient portal.`,\n  },\n  {\n    label: 'UA/UCX',\n    note: `Based on our medical evaluation, you will undergo a rapid urine test (urinalysis). Please go to ${PROJECT_NAME} to provide a urine sample. Be sure to drink plenty of fluids prior to coming to the office. The urine sample must be collected on site at ${PROJECT_NAME} using a sterile urine cup. We are unable to accept urine samples taken at home. If the urinalysis is positive, a provider at ${PROJECT_NAME} will be in contact with you within 2 hours and provide a prescription. If the urinalysis is negative, a confirmatory test (urine culture) will be sent to the lab and we will notify you if the results indicate a need for treatment. Urine culture results may take up to 5 days to return. All lab results and instructions from your child's provider can be found in your patient portal.`,\n  },\n  { label: SEND_OUT_VIRUS_TEST_LABEL },\n];\n\nexport const virusTestsOptions = ['Flu', 'RSV', 'COVID', 'Other'];\n\nexport const reasonsForTransferOptions = ['Equipment availability', 'Procedure or advanced care', 'Xray'];\n"]}