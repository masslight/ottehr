{"version":3,"file":"encounter.js","sourceRoot":"","sources":["encounter.ts"],"names":[],"mappings":";;AAgBA,0CAwCC;AAED,wDA4EC;AArID,yCAA8C;AAe9C,SAAgB,eAAe,CAAC,EAWd;QAVhB,SAAS,eAAA,EACT,SAAS,eAAA,EACT,kBAA4B,EAA5B,UAAU,mBAAG,2BAAe,KAAA,EAC5B,aAAa,mBAAA,EACb,cAAkB,EAAlB,MAAM,mBAAG,SAAS,KAAA,EAClB,sBAIC,EAJD,cAAc,mBAAG;QACf,MAAM,EAAE,oDAAoD;QAC5D,IAAI,EAAE,OAAO;QACb,OAAO,EAAE,iBAAiB;KAC3B,KAAA;IAED,OAAO;QACL,YAAY,EAAE,WAAW;QACzB,MAAM,EAAE,MAAM;QACd,aAAa,EAAE;YACb;gBACE,MAAM,EAAE,MAAM;gBACd,MAAM,EAAE;oBACN,KAAK,EAAE,SAAS;iBACjB;aACF;SACF;QACD,KAAK,EAAE,cAAc;QACrB,OAAO,EAAE;YACP,SAAS,EAAE,kBAAW,SAAS,CAAE;SAClC;QACD,WAAW,EAAE;YACX;gBACE,SAAS,EAAE,sBAAe,aAAa,CAAE;aAC1C;SACF;QACD,QAAQ,EAAE;YACR;gBACE,QAAQ,EAAE;oBACR,SAAS,EAAE,mBAAY,UAAU,CAAE;iBACpC;aACF;SACF;KACF,CAAC;AACJ,CAAC;AAED,SAAgB,sBAAsB,CAAC,EAMwD;QAL7F,SAAS,eAAA,EACT,SAAS,eAAA,EACT,kBAA4B,EAA5B,UAAU,mBAAG,2BAAe,KAAA,EAC5B,aAAa,mBAAA,EACb,cAAkB,EAAlB,MAAM,mBAAG,SAAS,KAAA;IAElB,OAAO;QACL,YAAY,EAAE,WAAW;QACzB,MAAM,EAAE,MAAM;QACd,aAAa,EAAE;YACb;gBACE,MAAM,EAAE,MAAM;gBACd,MAAM,EAAE;oBACN,KAAK,EAAE,SAAS;iBACjB;aACF;SACF;QACD,KAAK,EAAE;YACL,MAAM,EAAE,kDAAkD;YAC1D,IAAI,EAAE,IAAI;YACV,OAAO,EAAE,SAAS;SACnB;QACD,OAAO,EAAE;YACP,SAAS,EAAE,kBAAW,SAAS,CAAE;SAClC;QACD,WAAW,EAAE;YACX;gBACE,SAAS,EAAE,sBAAe,aAAa,CAAE;aAC1C;SACF;QACD,QAAQ,EAAE;YACR;gBACE,QAAQ,EAAE;oBACR,SAAS,EAAE,mBAAY,UAAU,CAAE;iBACpC;aACF;SACF;QACD,SAAS,EAAE;YACT;gBACE,GAAG,EAAE,0EAA0E;gBAC/E,SAAS,EAAE;oBACT;wBACE,GAAG,EAAE,aAAa;wBAClB,WAAW,EAAE;4BACX,MAAM,EAAE,8CAA8C;4BACtD,IAAI,EAAE,sBAAsB;4BAC5B,OAAO,EAAE,0BAA0B;yBACpC;qBACF;iBACF;aACF;YACD;gBACE,GAAG,EAAE,iEAAiE;gBACtE,SAAS,EAAE;oBACT;wBACE,GAAG,EAAE,gEAAgE;wBACrE,SAAS,EAAE;4BACT;gCACE,GAAG,EAAE,QAAQ;gCACb,WAAW,EAAE;oCACX,KAAK,EAAE,SAAS;iCACjB;6BACF;4BACD;gCACE,GAAG,EAAE,WAAW;gCAChB,cAAc,EAAE;oCACd,SAAS,EAAE,kBAAW,SAAS,CAAE;iCAClC;6BACF;yBACF;qBACF;iBACF;aACF;SACF;KACF,CAAC;AACJ,CAAC","sourcesContent":["import { Encounter } from 'fhir/r4b';\nimport { ENV_LOCATION_ID } from './constants';\n\nexport interface EncounterParams {\n  startTime: string;\n  patientId: string;\n  locationId?: string;\n  appointmentId?: string;\n  status?: Encounter['status'];\n  encounterClass?: {\n    system: string;\n    code: string;\n    display: string;\n  };\n}\n\nexport function createEncounter({\n  startTime,\n  patientId,\n  locationId = ENV_LOCATION_ID,\n  appointmentId,\n  status = 'planned',\n  encounterClass = {\n    system: 'http://hl7.org/fhir/R4/v3/ActEncounterCode/vs.html',\n    code: 'ACUTE',\n    display: 'inpatient acute',\n  },\n}: EncounterParams): Encounter {\n  return {\n    resourceType: 'Encounter',\n    status: status,\n    statusHistory: [\n      {\n        status: status,\n        period: {\n          start: startTime,\n        },\n      },\n    ],\n    class: encounterClass,\n    subject: {\n      reference: `Patient/${patientId}`,\n    },\n    appointment: [\n      {\n        reference: `Appointment/${appointmentId}`,\n      },\n    ],\n    location: [\n      {\n        location: {\n          reference: `Location/${locationId}`,\n        },\n      },\n    ],\n  };\n}\n\nexport function createTelemedEncounter({\n  startTime,\n  patientId,\n  locationId = ENV_LOCATION_ID,\n  appointmentId,\n  status = 'planned',\n}: Pick<EncounterParams, 'startTime' | 'patientId' | 'locationId' | 'appointmentId' | 'status'>): Encounter {\n  return {\n    resourceType: 'Encounter',\n    status: status,\n    statusHistory: [\n      {\n        status: status,\n        period: {\n          start: startTime,\n        },\n      },\n    ],\n    class: {\n      system: 'http://terminology.hl7.org/CodeSystem/v3-ActCode',\n      code: 'VR',\n      display: 'virtual',\n    },\n    subject: {\n      reference: `Patient/${patientId}`,\n    },\n    appointment: [\n      {\n        reference: `Appointment/${appointmentId}`,\n      },\n    ],\n    location: [\n      {\n        location: {\n          reference: `Location/${locationId}`,\n        },\n      },\n    ],\n    extension: [\n      {\n        url: 'https://extensions.fhir.zapehr.com/encounter-virtual-service-pre-release',\n        extension: [\n          {\n            url: 'channelType',\n            valueCoding: {\n              system: 'https://fhir.zapehr.com/virtual-service-type',\n              code: 'chime-video-meetings',\n              display: 'Twilio Video Group Rooms',\n            },\n          },\n        ],\n      },\n      {\n        url: 'https://extensions.fhir.zapehr.com/encounter-other-participants',\n        extension: [\n          {\n            url: 'https://extensions.fhir.zapehr.com/encounter-other-participant',\n            extension: [\n              {\n                url: 'period',\n                valuePeriod: {\n                  start: startTime,\n                },\n              },\n              {\n                url: 'reference',\n                valueReference: {\n                  reference: `Patient/${patientId}`,\n                },\n              },\n            ],\n          },\n        ],\n      },\n    ],\n  };\n}\n"]}