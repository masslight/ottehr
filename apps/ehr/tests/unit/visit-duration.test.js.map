{"version":3,"file":"visit-duration.test.js","sourceRoot":"","sources":["visit-duration.test.ts"],"names":[],"mappings":"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","sourcesContent":["// import { DateTime } from 'luxon';\n// import { getDurationOfStatus, getVisitTotalTime } from 'utils';\nimport { Encounter } from 'fhir/r4b';\nimport { getVisitStatusHistory } from 'utils';\nimport { describe, expect, test } from 'vitest';\n\nconst finishedEncounter: Encounter = {\n  resourceType: 'Encounter',\n  status: 'finished',\n  statusHistory: [\n    {\n      status: 'planned',\n      period: {\n        start: '2024-12-10T15:54:46.675Z',\n        end: '2024-12-10T17:38:15.605Z',\n      },\n    },\n    {\n      status: 'arrived',\n      period: {\n        start: '2024-12-10T17:38:15.605Z',\n        end: '2024-12-10T21:10:01.448Z',\n      },\n    },\n    {\n      status: 'in-progress',\n      period: {\n        start: '2024-12-10T21:10:01.448Z',\n        end: '2024-12-10T22:00:01.448Z',\n      },\n    },\n    {\n      status: 'finished',\n      period: {\n        start: '2024-12-10T22:00:01.448Z',\n      },\n    },\n  ],\n  class: {\n    system: 'http://hl7.org/fhir/R4/v3/ActEncounterCode/vs.html',\n    code: 'ACUTE',\n    display: 'inpatient acute',\n  },\n  subject: {\n    reference: 'Patient/432964e3-f114-40d8-bd49-5dd8ba511f50',\n  },\n  appointment: [\n    {\n      reference: 'Appointment/8fae0218-3bde-403f-9338-4f8438413f32',\n    },\n  ],\n  location: [\n    {\n      location: {\n        reference: 'Location/9b7f5d54-eaf6-4b3e-b13c-3ee4be417d10',\n      },\n    },\n  ],\n  meta: {\n    versionId: 'b4542438-6df4-4fa7-a536-68a32fc68417',\n    lastUpdated: '2024-12-10T22:08:21.191Z',\n  },\n  participant: [\n    {\n      period: {\n        start: '2024-12-10T21:10:01.448Z',\n        end: '2024-12-10T21:17:52.393Z',\n      },\n      individual: {\n        type: 'Practitioner',\n        reference: 'Practitioner/502a540d-c5f1-4af1-81bc-215b104bc04c',\n      },\n      type: [\n        {\n          coding: [\n            {\n              system: 'http://terminology.hl7.org/CodeSystem/v3-ParticipationType',\n              code: 'ADM',\n              display: 'admitter',\n            },\n          ],\n        },\n      ],\n    },\n    {\n      period: {\n        start: '2024-12-10T21:26:01.448Z',\n        end: '2024-12-10T21:36:01.448Z',\n      },\n      individual: {\n        type: 'Practitioner',\n        reference: 'Practitioner/502a540d-c5f1-4af1-81bc-215b104bc04c',\n      },\n      type: [\n        {\n          coding: [\n            {\n              system: 'http://terminology.hl7.org/CodeSystem/v3-ParticipationType',\n              code: 'ATND',\n              display: 'attender',\n            },\n          ],\n        },\n      ],\n    },\n  ],\n};\n\nconst unexpectedPractitioner: Encounter = {\n  resourceType: 'Encounter',\n  status: 'finished',\n  statusHistory: [\n    {\n      status: 'planned',\n      period: {\n        start: '2024-12-10T15:54:46.675Z',\n        end: '2024-12-10T17:38:15.605Z',\n      },\n    },\n    {\n      status: 'arrived',\n      period: {\n        start: '2024-12-10T17:38:15.605Z',\n        end: '2024-12-10T21:10:01.448Z',\n      },\n    },\n    {\n      status: 'in-progress',\n      period: {\n        start: '2024-12-10T21:10:01.448Z',\n        end: '2024-12-10T22:00:01.448Z',\n      },\n    },\n    {\n      status: 'finished',\n      period: {\n        start: '2024-12-10T22:00:01.448Z',\n      },\n    },\n  ],\n  class: {\n    system: 'http://hl7.org/fhir/R4/v3/ActEncounterCode/vs.html',\n    code: 'ACUTE',\n    display: 'inpatient acute',\n  },\n  subject: {\n    reference: 'Patient/432964e3-f114-40d8-bd49-5dd8ba511f50',\n  },\n  appointment: [\n    {\n      reference: 'Appointment/8fae0218-3bde-403f-9338-4f8438413f32',\n    },\n  ],\n  location: [\n    {\n      location: {\n        reference: 'Location/9b7f5d54-eaf6-4b3e-b13c-3ee4be417d10',\n      },\n    },\n  ],\n  meta: {\n    versionId: 'b4542438-6df4-4fa7-a536-68a32fc68417',\n    lastUpdated: '2024-12-10T22:08:21.191Z',\n  },\n  participant: [\n    {\n      period: {\n        start: '2024-12-10T21:10:01.448Z',\n        end: '2024-12-10T21:17:52.393Z',\n      },\n      individual: {\n        type: 'Practitioner',\n        reference: 'Practitioner/502a540d-c5f1-4af1-81bc-215b104bc04c',\n      },\n      type: [\n        {\n          coding: [\n            {\n              system: 'http://terminology.hl7.org/CodeSystem/v3-ParticipationType',\n              code: 'nurse',\n              display: 'Nurse',\n            },\n          ],\n        },\n      ],\n    },\n  ],\n};\n\n// todo add more tests for updated duration utils\ndescribe('visit duration tests', () => {\n  test('test visitStatusHistory for finished encounter ', () => {\n    const visitStatusHistory = getVisitStatusHistory(finishedEncounter);\n    expect(visitStatusHistory.length).toEqual(7);\n  });\n  test('test visitStatusHistory for encounter with an unexpected Practitioner', () => {\n    const visitStatusHistory = getVisitStatusHistory(unexpectedPractitioner);\n    expect(visitStatusHistory.length).toEqual(3);\n  });\n});\n"]}